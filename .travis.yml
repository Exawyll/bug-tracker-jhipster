sudo: required
os:
- linux
services:
- docker
language: node_js
node_js:
- 12.13.1
cache:
  directories:
  - node
  - node_modules
  - "$HOME/.m2"
  - "$HOME/.cache"
env:
  global:
  - NODE_VERSION=12.13.1
  - SPRING_OUTPUT_ANSI_ENABLED=ALWAYS
  - SPRING_JPA_SHOW_SQL=false
  - JHI_DISABLE_WEBPACK_LOGS=true
  - NG_CLI_ANALYTICS="false"
  - MAVEN_USER_HOME=$HOME/.m2/repository/
  - secure: WfmmDxvcAUD1MNRXMJsiptjnxE/hti9R8UDj3yF+qlJpAMpr48w/m+D8SqJPW33JgqWsfi+M774QgLlAsCXOIlEudXL8Td4k190tSJM0EiH1Gmp2nnjdn+mAYLD0JqWWhVSZRaIYBPA7TiXef0GxsJzoTUuWgIteXVNx18FN0PHXO+ASzEs/MbRpkE84JQVREGbYZwoi6V91ilb5EtY/m4ql6pIXgO6bo2Tc8kRelT7CxV4Xx5nLJ5cTswoNGM2Zck8d+7dYj/LtCKT9xX1G3A5RjDcdQEreOJCnWkDBFMvpjFElqQUg3i2dxyubZpGyAW+i9L/iRP90hl0ZZnOvnzzZgJfaqHz0z9iTKxjkn5IGjicSGHa+SLDHc3hRzx+QnSJDJYbCKLq0yhQkoVaghSH2Cvbf5xVhXE1FvFQXZtorRFQXIyIdWjOQlgsqCp0tB5XmjNoOZ7zINEpDL709je1ZbmAYAaHO3Vne4VgXvfuzPxXVvOMjeKRNI9X3A3AQsO2ESjLzgte3XBaDgv1Erdr/jZwe8LJH+NnMxkInVVj+MK4Pzl6TpKnOcQql9TCI8GT/Ylgaxgof74crBdmCSAljrCGsv/3TW52+1HPiyQLy4hyhC5ZnoFDLxf+vFpQy88yHy8+38csVwifwO8E+y1wjmOlIfFFmNDVjKCeWL3k=
before_install:
- echo $super_secret_password | gpg --passphrase-fd 0 client-secret.json.gpg
- |
  if [[ $JHI_JDK = '8' ]]; then
    echo '*** Using OpenJDK 8'
  else
    echo '*** Using OpenJDK 11 by default'
    sudo add-apt-repository ppa:openjdk-r/ppa -y
    sudo apt-get update -q
    sudo apt-get install -y openjdk-11-jdk -y
    sudo update-java-alternatives -s java-1.11.0-openjdk-amd64
    java -version
  fi
- java -version
- sudo /etc/init.d/mysql stop
- sudo /etc/init.d/postgresql stop
- nvm install $NODE_VERSION
- npm install -g npm
- node -v
- npm -v
install:
- npm install
script:
- chmod +x mvnw
- "./mvnw -ntp checkstyle:check"
- "./mvnw -ntp clean verify"
- "./mvnw -ntp com.github.eirslett:frontend-maven-plugin:npm -Dfrontend.npm.arguments='run
  test' -Dmaven.repo.local=$MAVEN_USER_HOME"
- "./mvnw -ntp verify -Pprod -DskipTests"
notifications:
  webhooks:
    on_success: change
    on_failure: always
    on_start: false
